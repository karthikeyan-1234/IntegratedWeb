<div class="table-container">
  <div class="table-scroll-container">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z1">

      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>ID</th>
        <td mat-cell *matCellDef="let element">{{element.id}}</td>
      </ng-container>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Name</th>
        <td mat-cell *matCellDef="let element">
          @if (element.id == editedId) {
            <input matInput [(ngModel)]="element.name" />
          } @else {
            {{element.name}}
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef>Price</th>
        <td mat-cell *matCellDef="let element">
          @if (element.id == editedId) {
            <input matInput [(ngModel)]="element.price" />
          } @else {
            {{element.price | currency}}
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let element">
          @if (element.id == editedId) {
            <input matInput [(ngModel)]="element.description" />
          } @else {
            {{element.description || '-'}}
          }
        </td>
      </ng-container>

      <!-- Action Column for Edit/Delete -->
      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="text-center">Actions</th>
        <td mat-cell *matCellDef="let element" class="actions-cell">
          <div class="action-buttons">

            @if (element.id != editedId) {
              <!-- Edit Button -->
              <button mat-icon-button class="edit-button" (click)="editProduct(element)"
                aria-label="Edit product"
                matTooltip="Edit">
                <mat-icon>edit</mat-icon>
              </button>
              <!-- Delete Button -->
              <button mat-icon-button class="delete-button" (click)="deleteProduct(element)"
                aria-label="Delete product"
                matTooltip="Delete">
                <mat-icon>delete</mat-icon>
              </button>
            } @else {
              <!-- Save Button -->
              <button mat-icon-button class="edit-button" (click)="saveProduct(element)"
                aria-label="Save product"
                matTooltip="Save">
                <mat-icon>save</mat-icon>
              </button>
              <!-- Cancel Button -->
              <button mat-icon-button class="delete-button" (click)="cancelEdit()"
                aria-label="Cancel Edit"
                matTooltip="Cancel">
                <mat-icon>cancel</mat-icon>
              </button>
            }

          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayCols"></tr>
      <tr mat-row *matRowDef="let row; columns: displayCols"></tr>

      <!-- Empty State Row -->
      <tr *matNoDataRow>
        <td class="no-data-cell" [attr.colspan]="displayCols.length">
          No products found. Add your first product!
        </td>
      </tr>

    </table>
  </div>
</div>