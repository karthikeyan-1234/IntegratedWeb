<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Angular App Deployment Guide - Jenkins, Kubernetes & Kong</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        header {
            border-bottom: 4px solid #0066cc;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #0066cc;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        
        .meta-info {
            display: flex;
            gap: 30px;
            color: #666;
            font-size: 0.9em;
            flex-wrap: wrap;
        }
        
        .meta-info span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        h2 {
            color: #0066cc;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        h3 {
            color: #333;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 12px;
        }
        
        h4 {
            color: #555;
            font-size: 1.1em;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        p {
            margin-bottom: 15px;
        }
        
        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }
        
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }
        
        .info-box {
            background-color: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .success-box {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .command-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .command-box strong {
            display: block;
            margin-bottom: 10px;
            color: #0066cc;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95em;
        }
        
        th {
            background-color: #0066cc;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .checklist {
            list-style: none;
            margin-left: 0;
        }
        
        .checklist li:before {
            content: "âœ“ ";
            color: #28a745;
            font-weight: bold;
            margin-right: 8px;
        }
        
        .architecture-diagram {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            text-align: center;
        }
        
        .toc {
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 5px;
            margin: 30px 0;
        }
        
        .toc h2 {
            margin-top: 0;
        }
        
        .toc ul {
            margin-left: 20px;
        }
        
        .toc a {
            color: #0066cc;
            text-decoration: none;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
        
        .file-path {
            background-color: #fff8e1;
            padding: 8px 12px;
            border-left: 3px solid #ffc107;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
                padding: 20px;
            }
            
            pre {
                page-break-inside: avoid;
            }
            
            h2 {
                page-break-after: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Angular App Deployment Guide</h1>
            <p class="subtitle">Complete CI/CD Pipeline with Jenkins, Kubernetes & Kong Gateway</p>
            <div class="meta-info">
                <span><strong>Author:</strong> CI/CD Implementation Guide</span>
                <span><strong>Date:</strong> October 12, 2025</span>
                <span><strong>Version:</strong> 1.0</span>
            </div>
        </header>

        <div class="toc">
            <h2>Table of Contents</h2>
            <ol>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#prerequisites">Prerequisites</a></li>
                <li><a href="#architecture">Architecture</a></li>
                <li><a href="#section1">Section 1: Prepare Angular Application</a></li>
                <li><a href="#section2">Section 2: Create Kubernetes Deployment Files</a></li>
                <li><a href="#section3">Section 3: Create Jenkins Pipeline</a></li>
                <li><a href="#section4">Section 4: Configure Kong Gateway Routing</a></li>
                <li><a href="#section5">Section 5: Testing and Verification</a></li>
                <li><a href="#troubleshooting">Troubleshooting Guide</a></li>
                <li><a href="#appendix">Appendix: Configuration Files</a></li>
            </ol>
        </div>

        <section id="overview">
            <h2>Overview</h2>
            <p>This guide provides step-by-step instructions to set up a complete CI/CD pipeline for deploying an Angular application using Jenkins, Docker Desktop Kubernetes, and Kong Gateway.</p>
            
            <h3>What You'll Build</h3>
            <ul>
                <li><strong>Source Control:</strong> GitHub repository (https://github.com/karthikeyan-1234/IntegratedWeb)</li>
                <li><strong>CI/CD Tool:</strong> Jenkins for automated build and deployment</li>
                <li><strong>Containerization:</strong> Docker for creating Nginx container with Angular app</li>
                <li><strong>Orchestration:</strong> Docker Desktop Kubernetes in default namespace</li>
                <li><strong>Gateway:</strong> Kong Gateway in kong namespace for routing</li>
                <li><strong>Registry:</strong> Docker Hub for storing container images</li>
            </ul>

            <h3>Complete Workflow</h3>
            <ol>
                <li>Developer pushes Angular code to GitHub</li>
                <li>Jenkins detects changes (SCM polling every minute)</li>
                <li>Jenkins builds the Angular project</li>
                <li>Jenkins creates Docker image with Nginx</li>
                <li>Docker image is pushed to Docker Hub</li>
                <li>Kubernetes deploys the Angular application</li>
                <li>Kong Gateway routes traffic to Angular app</li>
                <li>Application accessible at http://kong-proxy.local/web</li>
            </ol>
        </section>

        <section id="prerequisites">
            <h2>Prerequisites</h2>
            
            <h3>Software Requirements</h3>
            <ul>
                <li><strong>Windows 10/11</strong> - Operating System</li>
                <li><strong>Docker Desktop</strong> - Installed and running with Kubernetes enabled</li>
                <li><strong>Jenkins</strong> - Installed and running at http://localhost:8080</li>
                <li><strong>Git</strong> - Installed for version control</li>
                <li><strong>Node.js & npm</strong> - For local Angular development (optional)</li>
            </ul>

            <h3>Accounts Required</h3>
            <ul>
                <li><strong>GitHub Account</strong> - For source code repository</li>
                <li><strong>Docker Hub Account</strong> - For storing Docker images</li>
            </ul>

            <h3>Existing Infrastructure</h3>
            <ul>
                <li><strong>Jenkins URL:</strong> http://localhost:8080</li>
                <li><strong>Docker Hub Username:</strong> karthiknat</li>
                <li><strong>Kong Namespace:</strong> kong (already deployed)</li>
                <li><strong>Kong Admin URL:</strong> http://kong-admin.local</li>
                <li><strong>Kong Proxy URL:</strong> http://kong-proxy.local</li>
                <li><strong>GitHub Repository:</strong> https://github.com/karthikeyan-1234/IntegratedWeb</li>
            </ul>

            <div class="info-box">
                <strong>Note:</strong> This guide assumes you already have Kong deployed in the 'kong' namespace with Ingress configured as per the previous guide.
            </div>
        </section>

        <section id="architecture">
            <h2>Architecture</h2>
            <div class="architecture-diagram">
                <pre style="text-align: left;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GitHub    â”‚â”€â”€â”€â”€â”€â–¶â”‚   Jenkins    â”‚â”€â”€â”€â”€â”€â–¶â”‚ Docker Hub  â”‚
â”‚ Repository  â”‚      â”‚   Pipeline   â”‚      â”‚  Registry   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                      â”‚
                            â”‚                      â”‚
                            â–¼                      â–¼
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Docker Desktop Kubernetes       â”‚
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                     â”‚  â”‚  Kong Gateway (kong ns)    â”‚  â”‚
                     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
                     â”‚  â”‚  â”‚ Angular App Route  â”‚â”€â”€â”€â”€â”¼â”€â”€â”˜
                     â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â”‚              â”‚                   â”‚
                     â”‚              â–¼                   â”‚
                     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                     â”‚  â”‚  Angular Pod (default ns)  â”‚  â”‚
                     â”‚  â”‚  Port: 80 (Nginx)          â”‚  â”‚
                     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                    http://kong-proxy.local/web

                </pre>
            </div>
        </section>

        <section id="section1">
            <h2>Section 1: Prepare Angular Application</h2>

            <h3>1.1: Clone the Repository</h3>
            
            <div class="command-box">
                <strong>Clone the Angular project:</strong>
                <pre><code>cd C:\Users\mail2\source\repos
git clone https://github.com/karthikeyan-1234/IntegratedWeb.git
cd IntegratedWeb</code></pre>
            </div>

            <h3>1.2: Review Project Structure</h3>
            
            <div class="file-path">
                <strong>Expected Structure:</strong> C:\Users\mail2\source\repos\IntegratedWeb\
            </div>

            <pre><code>IntegratedWeb/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ environments/
â”œâ”€â”€ angular.json
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ (other Angular files)</code></pre>

            <h3>1.3: Create Dockerfile</h3>

            <div class="file-path">
                <strong>Create File:</strong> C:\Users\mail2\source\repos\IntegratedWeb\Dockerfile
            </div>

            <pre><code># Build stage
FROM node:18-alpine AS build
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci

# Copy source code
COPY . .

# Build the Angular app
RUN npm run build -- --configuration=production

# Production stage
FROM nginx:alpine

# Copy built app to nginx html directory
COPY --from=build /app/dist/integrated-web /usr/share/nginx/html

# Copy custom nginx config if needed
# COPY nginx.conf /etc/nginx/nginx.conf

# Expose port 80
EXPOSE 80

# Start nginx
CMD ["nginx", "-g", "daemon off;"]</code></pre>

            <h3>1.4: Create .dockerignore file</h3>

            <div class="file-path">
                <strong>Create File:</strong> C:\Users\mail2\source\repos\IntegratedWeb\.dockerignore
            </div>

            <pre><code>node_modules
npm-debug.log
.git
.gitignore
README.md
.env
.angular
dist
coverage</code></pre>
        </section>

        <section id="section2">
            <h2>Section 2: Create Kubernetes Deployment Files</h2>

            <h3>2.1: Create Angular Deployment File</h3>
            
            <div class="file-path">
                <strong>Create File:</strong> C:\Users\mail2\source\repos\IntegratedWeb\angular-deploy.yml
            </div>

            <pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: angular-app-deployment
  namespace: default
  labels:
    app: angular-app
spec:
  replicas: 1
  selector:
    matchLabels:
      app: angular-app
  template:
    metadata:
      labels:
        app: angular-app
    spec:
      containers:
      - name: angular-app
        image: karthiknat/integrated-web:latest
        imagePullPolicy: Always
        ports:
        - containerPort: 80
        resources:
          requests:
            memory: "128Mi"
            cpu: "100m"
          limits:
            memory: "256Mi"
            cpu: "200m"
---
apiVersion: v1
kind: Service
metadata:
  name: angular-app-service
  namespace: default
  labels:
    app: angular-app
spec:
  selector:
    app: angular-app
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
      name: http</code></pre>

            <div class="info-box">
                <strong>Note:</strong> The service uses ClusterIP type (default) since it will be accessed internally by Kong Gateway.
            </div>

            <h3>2.2: Verify Kubernetes Context</h3>

            <div class="command-box">
                <strong>Check current Kubernetes context:</strong>
                <pre><code>kubectl config current-context
kubectl get nodes</code></pre>
            </div>

            <div class="success-box">
                <strong>Expected Output:</strong>
                <pre><code>docker-desktop
NAME             STATUS   ROLES           AGE   VERSION
docker-desktop   Ready    control-plane   5m    v1.29.x</code></pre>
            </div>
        </section>

        <section id="section3">
            <h2>Section 3: Create Jenkins Pipeline</h2>

            <h3>3.1: Create Jenkinsfile</h3>

            <div class="file-path">
                <strong>Create File:</strong> C:\Users\mail2\source\repos\IntegratedWeb\Jenkinsfile
            </div>

            <pre><code>pipeline {
    agent any
    
    environment {
        DOCKER_IMAGE = 'karthiknat/integrated-web'
        IMAGE_TAG = "${BUILD_NUMBER}"
    }
    
    stages {
        stage('Checkout') {
            steps {
                echo 'Checking out Angular application code...'
                checkout scm
            }
        }
        
        stage('Install Dependencies') {
            steps {
                echo 'Installing Node.js dependencies...'
                script {
                    bat "npm ci"
                }
            }
        }
        
        stage('Build Angular App') {
            steps {
                echo 'Building Angular application...'
                script {
                    bat "npm run build -- --configuration=production"
                }
            }
        }
        
        stage('Build Docker Image') {
            steps {
                echo 'Building Docker image...'
                script {
                    bat "docker build -t ${DOCKER_IMAGE}:${IMAGE_TAG} -t ${DOCKER_IMAGE}:latest ."
                }
            }
        }
        
        stage('Push to Docker Hub') {
            steps {
                echo 'Pushing Docker image to Docker Hub...'
                script {
                    withCredentials([usernamePassword(credentialsId: 'dockerhub-credentials', usernameVariable: 'DOCKER_USER', passwordVariable: 'DOCKER_PASS')]) {
                        bat "docker login -u %DOCKER_USER% -p %DOCKER_PASS%"
                        bat "docker push ${DOCKER_IMAGE}:${IMAGE_TAG}"
                        bat "docker push ${DOCKER_IMAGE}:latest"
                    }
                }
            }
        }
        
        stage('Deploy to Kubernetes') {
            steps {
                echo 'Deploying to Docker Desktop Kubernetes...'
                script {
                    withCredentials([file(credentialsId: 'kube-config', variable: 'KUBECONFIG')]) {
                        bat "kubectl apply -f angular-deploy.yml --kubeconfig=%KUBECONFIG%"
                        bat "kubectl rollout restart deployment/angular-app-deployment --kubeconfig=%KUBECONFIG%"
                        bat "kubectl rollout status deployment/angular-app-deployment --kubeconfig=%KUBECONFIG%"
                    }
                }
            }
        }
    }
    
    post {
        success {
            echo 'Angular application build and deployment successful!'
            echo 'Application will be accessible at: http://kong-proxy.local/web'
            echo 'After configuring Kong routing in the next section'
        }
        failure {
            echo 'Pipeline failed. Check logs for details.'
        }
    }
}</code></pre>

            <h3>3.2: Commit and Push Files to GitHub</h3>

            <div class="command-box">
                <strong>Add and commit all files:</strong>
                <pre><code>cd C:\Users\mail2\source\repos\IntegratedWeb
git add .
git commit -m "Add Dockerfile, Kubernetes deployment, and Jenkinsfile for CI/CD"
git push origin main</code></pre>
            </div>

            <h3>3.3: Create Jenkins Pipeline Job</h3>

            <ol>
                <li>Open Jenkins: http://localhost:8080</li>
                <li>Click <strong>New Item</strong></li>
                <li>Enter name: <code>IntegratedWeb-Angular-Pipeline</code></li>
                <li>Select <strong>Pipeline</strong></li>
                <li>Click <strong>OK</strong></li>
                <li>Configure Build Triggers:
                    <ul>
                        <li>Check â˜‘ <strong>Poll SCM</strong></li>
                        <li>Schedule: <code>* * * * *</code> (checks every minute)</li>
                    </ul>
                </li>
                <li>Configure Pipeline:
                    <ul>
                        <li><strong>Definition:</strong> Pipeline script from SCM</li>
                        <li><strong>SCM:</strong> Git</li>
                        <li><strong>Repository URL:</strong> <code>https://github.com/karthikeyan-1234/IntegratedWeb.git</code></li>
                        <li><strong>Branch Specifier:</strong> <code>*/main</code></li>
                        <li><strong>Script Path:</strong> <code>Jenkinsfile</code></li>
                    </ul>
                </li>
                <li>Click <strong>Save</strong></li>
            </ol>

            <h3>3.4: Trigger First Build</h3>

            <ol>
                <li>Go to Jenkins: http://localhost:8080</li>
                <li>Click <code>IntegratedWeb-Angular-Pipeline</code></li>
                <li>Click <strong>Build Now</strong></li>
                <li>Watch build progress in <strong>Console Output</strong></li>
                <li>Wait for all stages to complete (3-6 minutes)</li>
            </ol>

            <div class="success-box">
                <strong>After successful build, verify deployment:</strong>
                <pre><code>kubectl get pods -l app=angular-app
kubectl get svc angular-app-service</code></pre>
            </div>
        </section>

        <section id="section4">
            <h2>Section 4: Configure Kong Gateway Routing</h2>

            <h3>4.1: Verify Kong is Accessible</h3>

            <div class="command-box">
                <strong>Test Kong Admin API:</strong>
                <pre><code># PowerShell
Invoke-RestMethod -Uri "http://kong-admin.local/status"</code></pre>
            </div>

            <div class="response-block">
                <strong>Expected Response:</strong> Should show Kong status with database connected.
            </div>

            <h3>4.2: Register Angular Service in Kong</h3>

            <div class="command-box">
                <strong>Create Kong Service for Angular app:</strong>
                <pre><code># PowerShell
Invoke-RestMethod -Uri "http://kong-admin.local/services/" `
    -Method Post `
    -Body @{
        name="angular-app-service"
        url="http://angular-app-service.default.svc.cluster.local:80"
    }</code></pre>
            </div>

            <div class="info-box">
                <strong>Service URL Explanation:</strong>
                <ul>
                    <li><strong>angular-app-service</strong> - Kubernetes service name</li>
                    <li><strong>default</strong> - Namespace where Angular app is deployed</li>
                    <li><strong>svc.cluster.local</strong> - Kubernetes internal DNS domain</li>
                    <li><strong>80</strong> - Service port (Nginx default port)</li>
                </ul>
            </div>

            <h3>4.3: Create Route for Angular Application</h3>

            <div class="command-box">
                <strong>Create route with /web path:</strong>
                <pre><code># PowerShell
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service/routes" `
    -Method POST `
    -ContentType 'application/json' `
    -Body (@{
        name="angular-app-route"
        paths=@("/web")
        strip_path=$false
        preserve_host=$true
    } | ConvertTo-Json -Depth 4)</code></pre>
            </div>

            <h3>4.4: Verify Service and Route Creation</h3>

            <div class="command-box">
                <strong>Check Kong configuration:</strong>
                <pre><code># List all services
Invoke-RestMethod -Uri "http://kong-admin.local/services/" | ConvertTo-Json -Depth 3

# List routes for angular service
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service/routes" | ConvertTo-Json -Depth 3</code></pre>
            </div>

            <h3>4.5: Optional - Configure Additional Routes</h3>

            <p>If you need to serve the Angular app from the root path:</p>

            <div class="command-box">
                <strong>Create root path route:</strong>
                <pre><code># PowerShell - Optional root route
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service/routes" `
    -Method POST `
    -ContentType 'application/json' `
    -Body (@{
        name="angular-app-root-route"
        paths=@("/")
        strip_path=$false
        preserve_host=$true
    } | ConvertTo-Json -Depth 4)</code></pre>
            </div>

            <div class="warning-box">
                <strong>Note:</strong> Be careful with root path routes as they might conflict with other services. The /web path is recommended for better organization.
            </div>
        </section>

        <section id="section5">
            <h2>Section 5: Testing and Verification</h2>

            <h3>5.1: Verify Kubernetes Deployment</h3>

            <div class="command-box">
                <strong>Check all components are running:</strong>
                <pre><code># Check Angular app pods
kubectl get pods -l app=angular-app

# Check Angular service
kubectl get svc angular-app-service

# Check Kong pods
kubectl get pods -n kong

# Check all services
kubectl get svc --all-namespaces</code></pre>
            </div>

            <h3>5.2: Test Angular App Through Kong</h3>

            <div class="command-box">
                <strong>Test the Angular application:</strong>
                <pre><code># PowerShell - Test through Kong proxy
Invoke-RestMethod -Uri "http://kong-proxy.local/web/"

# Or open in browser
Start-Process "http://kong-proxy.local/web/"</code></pre>
            </div>

            <h3>5.3: Test Direct Kubernetes Access (Optional)</h3>

            <div class="command-box">
                <strong>Port forward for direct testing:</strong>
                <pre><code># Port forward to Angular service
kubectl port-forward svc/angular-app-service 8080:80

# Test directly (in new terminal)
Invoke-RestMethod -Uri "http://localhost:8080/"</code></pre>
            </div>

            <h3>5.4: Verify Complete Setup</h3>

            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Status Check</th>
                        <th>Expected Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Angular Deployment</td>
                        <td><code>kubectl get deployment angular-app-deployment</code></td>
                        <td>1/1 READY</td>
                    </tr>
                    <tr>
                        <td>Angular Service</td>
                        <td><code>kubectl get svc angular-app-service</code></td>
                        <td>ClusterIP, port 80</td>
                    </tr>
                    <tr>
                        <td>Kong Service</td>
                        <td><code>Invoke-RestMethod "http://kong-admin.local/services/angular-app-service"</code></td>
                        <td>Returns service details</td>
                    </tr>
                    <tr>
                        <td>Kong Route</td>
                        <td><code>Invoke-RestMethod "http://kong-admin.local/routes/angular-app-route"</code></td>
                        <td>Returns route details with /web path</td>
                    </tr>
                    <tr>
                        <td>End-to-End</td>
                        <td><code>Invoke-RestMethod "http://kong-proxy.local/web/"</code></td>
                        <td>Returns Angular app HTML</td>
                    </tr>
                </tbody>
            </table>

            <h3>5.5: Access Points Summary</h3>

            <table>
                <thead>
                    <tr>
                        <th>Access Method</th>
                        <th>URL</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Kong Proxy</td>
                        <td>http://kong-proxy.local/web/</td>
                        <td>Production access via Kong</td>
                    </tr>
                    <tr>
                        <td>Kong Admin</td>
                        <td>http://kong-admin.local/</td>
                        <td>Kong configuration</td>
                    </tr>
                    <tr>
                        <td>Jenkins</td>
                        <td>http://localhost:8080</td>
                        <td>CI/CD pipeline management</td>
                    </tr>
                    <tr>
                        <td>GitHub</td>
                        <td>https://github.com/karthikeyan-1234/IntegratedWeb</td>
                        <td>Source code repository</td>
                    </tr>
                    <tr>
                        <td>Docker Hub</td>
                        <td>https://hub.docker.com/r/karthiknat/integrated-web</td>
                        <td>Container image registry</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="troubleshooting">
            <h2>Troubleshooting Guide</h2>

            <h3>Issue 1: Jenkins Build Fails - npm Command Not Found</h3>

            <div class="command-box">
                <strong>Solution:</strong>
                <pre><code># Verify Node.js is installed on Jenkins agent
# In Jenkins Script Console:
def proc = "node --version".execute()
proc.waitFor()
println proc.text</code></pre>
            </div>

            <p><strong>Alternative:</strong> Use Node.js Docker image for build stage or install Node.js on Jenkins agent.</p>

            <h3>Issue 2: Angular Build Failures</h3>

            <div class="command-box">
                <strong>Check build logs:</strong>
                <pre><code># Look for specific error messages in Jenkins console output
# Common issues:
# - Missing dependencies (run npm ci)
# - TypeScript compilation errors
# - Memory issues during build</code></pre>
            </div>

            <h3>Issue 3: Docker Build Failures</h3>

            <div class="command-box">
                <strong>Verify Dockerfile:</strong>
                <pre><code># Test Docker build locally
docker build -t test-angular .

# Check for:
# - Correct build context
# - Proper multi-stage build
# - Nginx configuration</code></pre>
            </div>

            <h3>Issue 4: Kubernetes Deployment Failures</h3>

            <div class="command-box">
                <strong>Debug deployment:</strong>
                <pre><code># Check pod status and logs
kubectl describe pod -l app=angular-app
kubectl logs -l app=angular-app

# Verify image exists and accessible
kubectl get events --sort-by=.metadata.creationTimestamp</code></pre>
            </div>

            <h3>Issue 5: Kong Routing Not Working</h3>

            <div class="command-box">
                <strong>Debug Kong configuration:</strong>
                <pre><code># Verify service and route
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service" | ConvertTo-Json
Invoke-RestMethod -Uri "http://kong-admin.local/routes/angular-app-route" | ConvertTo-Json

# Check Kong logs
kubectl logs -n kong deployment/kong

# Test internal connectivity
kubectl exec -it $(kubectl get pod -l app=angular-app -o jsonpath="{.items[0].metadata.name}") -- nslookup angular-app-service</code></pre>
            </div>

            <h3>Issue 6: 404 Errors from Kong</h3>

            <div class="command-box">
                <strong>Check path configuration:</strong>
                <pre><code># Verify route path and strip_path setting
Invoke-RestMethod -Uri "http://kong-admin.local/routes/angular-app-route" | ConvertTo-Json

# Test different paths
Invoke-RestMethod -Uri "http://kong-proxy.local/web/"
Invoke-RestMethod -Uri "http://kong-proxy.local/web/index.html"</code></pre>
            </div>

            <h3>General Debugging Commands</h3>

            <table>
                <thead>
                    <tr>
                        <th>Purpose</th>
                        <th>Command</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>View all pods</td>
                        <td><code>kubectl get pods --all-namespaces</code></td>
                    </tr>
                    <tr>
                        <td>View service details</td>
                        <td><code>kubectl describe svc angular-app-service</code></td>
                    </tr>
                    <tr>
                        <td>Check pod logs</td>
                        <td><code>kubectl logs -l app=angular-app -f</code></td>
                    </tr>
                    <tr>
                        <td>Test service internally</td>
                        <td><code>kubectl port-forward svc/angular-app-service 8080:80</code></td>
                    </tr>
                    <tr>
                        <td>Check Kong status</td>
                        <td><code>Invoke-RestMethod "http://kong-admin.local/status"</code></td>
                    </tr>
                    <tr>
                        <td>View Kong services</td>
                        <td><code>Invoke-RestMethod "http://kong-admin.local/services"</code></td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="appendix">
            <h2>Appendix: Configuration Files Reference</h2>

            <h3>Complete File Structure</h3>

            <pre><code>IntegratedWeb/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ angular-deploy.yml
â”œâ”€â”€ Jenkinsfile
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ assets/
â”‚   â””â”€â”€ environments/
â”œâ”€â”€ angular.json
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json</code></pre>

            <h3>Kubernetes Service DNS Names</h3>

            <table>
                <thead>
                    <tr>
                        <th>Service</th>
                        <th>Internal DNS</th>
                        <th>Access Method</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>angular-app-service</td>
                        <td>angular-app-service.default.svc.cluster.local:80</td>
                        <td>Kong Gateway</td>
                    </tr>
                    <tr>
                        <td>kong-admin</td>
                        <td>kong-admin.kong.svc.cluster.local:8001</td>
                        <td>Ingress (kong-admin.local)</td>
                    </tr>
                    <tr>
                        <td>kong-proxy</td>
                        <td>kong-proxy.kong.svc.cluster.local:8000</td>
                        <td>Ingress (kong-proxy.local)</td>
                    </tr>
                </tbody>
            </table>

            <h3>Quick Reference Commands</h3>

            <h4>Kubernetes Commands</h4>
            <pre><code># Deploy Angular app
kubectl apply -f angular-deploy.yml

# Check deployment
kubectl get deployment angular-app-deployment

# View pods
kubectl get pods -l app=angular-app

# View logs
kubectl logs -l app=angular-app

# Restart deployment
kubectl rollout restart deployment/angular-app-deployment</code></pre>

            <h4>Kong Commands</h4>
            <pre><code># Create service
Invoke-RestMethod -Uri "http://kong-admin.local/services/" -Method Post -Body @{name="angular-app-service";url="http://angular-app-service.default.svc.cluster.local:80"}

# Create route
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service/routes" -Method POST -ContentType 'application/json' -Body (@{name="angular-app-route";paths=@("/web");strip_path=$false} | ConvertTo-Json)

# Verify configuration
Invoke-RestMethod -Uri "http://kong-admin.local/services/angular-app-service/routes" | ConvertTo-Json</code></pre>

            <h4>Jenkins Pipeline Stages</h4>
            <ol>
                <li><strong>Checkout:</strong> Pulls code from GitHub</li>
                <li><strong>Install Dependencies:</strong> Runs npm ci</li>
                <li><strong>Build Angular:</strong> Creates production build</li>
                <li><strong>Docker Build:</strong> Creates container image</li>
                <li><strong>Docker Push:</strong> Uploads to Docker Hub</li>
                <li><strong>Kubernetes Deploy:</strong> Deploys to cluster</li>
            </ol>

            <h3>Custom Nginx Configuration (Optional)</h3>

            <p>If you need to customize Nginx behavior, create an nginx.conf file:</p>

            <div class="file-path">
                <strong>Create File:</strong> C:\Users\mail2\source\repos\IntegratedWeb\nginx.conf
            </div>

            <pre><code>events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    server {
        listen 80;
        server_name localhost;
        root /usr/share/nginx/html;
        index index.html;

        # Angular routing support
        location / {
            try_files $uri $uri/ /index.html;
        }

        # Cache static assets
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
}</code></pre>

            <p>Then update your Dockerfile to copy this configuration:</p>
            <pre><code># In Dockerfile, replace:
# COPY nginx.conf /etc/nginx/nginx.conf</code></pre>
        </section>

        <footer style="margin-top: 50px; padding-top: 20px; border-top: 2px solid #e0e0e0; text-align: center; color: #666;">
            <p><strong>Angular App Deployment Guide - Version 1.0</strong></p>
            <p>Complete CI/CD pipeline with Jenkins, Kubernetes, and Kong Gateway</p>
            <p>Generated on October 12, 2025</p>
        </footer>
    </div>

    <script>
        // Add download functionality
        document.addEventListener('DOMContentLoaded', function() {
            const style = document.createElement('style');
            style.textContent = `
                .download-btn {
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #0066cc;
                    color: white;
                    padding: 10px 20px;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 14px;
                    z-index: 1000;
                }
                .download-btn:hover {
                    background: #0052a3;
                }
            `;
            document.head.appendChild(style);

            const downloadBtn = document.createElement('button');
            downloadBtn.className = 'download-btn';
            downloadBtn.textContent = 'ğŸ“¥ Download Guide';
            downloadBtn.onclick = downloadGuide;
            document.body.appendChild(downloadBtn);

            function downloadGuide() {
                const htmlContent = document.documentElement.outerHTML;
                const blob = new Blob([htmlContent], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'angular-app-deployment-guide.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        });
    </script>
</body>
</html>